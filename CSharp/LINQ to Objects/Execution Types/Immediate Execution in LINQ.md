- When you need to evaluate a LINQ expression resulting in a sequence from outside the confines of foreach logic, you can call any number of extension methods defined by the Enumerable type such as ToArray\<T>(), ToDictionary\<TSource,TKey>(), and ToList.\<T>(). These methods will cause a LINQ query to execute at the exact moment you call one of the extension methods to obtain a snapshot of the data. After you have done so, the snapshot of data may be independently manipulated.
- Additionally, if you are seeking only a single element, the query is executed immediately. First() returns the first member of the sequence (and should always be used with an OrderBy() or OrderByDescending()). FirstOrDefault() returns the default value for the type of item in the list if there aren’t any to return, such as when the original sequence is empty or the Where() clause filters out all elements. Single() also returns the first member of the sequence (based on the Orderby()/ OrderByDescending(), or element order if there isn’t an ordering clause). Like its similarly named counterpart, SingleOrDefault() returns the default value for the element type if there aren’t any items in the sequence (or all records are filtered out by a where clause). If no records are returned, First() and Single() throw an exception that no records were returned, while FirstOrDefault() and SingleOrDefault() simply return null. The difference between First()/FirstOrDefault() and Single()/SingleOr() is that Single()/SingleOrDefault() will throw an exception if more than one element is returned from the query.